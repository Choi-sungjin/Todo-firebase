<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>í• ì¼</title>
  <link rel="icon" type="image/png" href="/favicon.png" />
  <link rel="shortcut icon" type="image/png" href="/favicon.png" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/motion.css" />
  <script>
    (function () {
      var t = localStorage.getItem("theme");
      if (t === "dark" || (!t && window.matchMedia("(prefers-color-scheme: dark)").matches))
        document.documentElement.setAttribute("data-theme", "dark");
      else
        document.documentElement.setAttribute("data-theme", "light");
    })();
  </script>
</head>
<body>

  <!-- í—¤ë” -->
  <header class="header">
    <div class="header-top">
      <button class="theme-toggle" id="theme-toggle" type="button" title="ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ ì „í™˜" aria-label="í…Œë§ˆ ì „í™˜"></button>
      <div class="header-title-wrap">
        <p class="header-date" id="header-date"></p>
        <h1 class="header-title">ë‚˜ì˜ í• ì¼</h1>
      </div>
      <button class="add-fab" id="open-modal">ï¼‹</button>
    </div>

    <!-- íƒ­: ì˜¤ëŠ˜ / ë‚´ì¼ / ì „ì²´ì¼ì • / ì§€ë‚œì¼ì • -->
    <div class="tab-group">
      <button class="tab active" data-tab="today">ì˜¤ëŠ˜</button>
      <button class="tab" data-tab="tomorrow">ë‚´ì¼</button>
      <button class="tab" data-tab="all">ì „ì²´ì¼ì •</button>
      <button class="tab" data-tab="past">ì§€ë‚œì¼ì •</button>
    </div>
  </header>

  <!-- í• ì¼ ëª©ë¡ -->
  <main class="todo-list" id="todo-list">
    <div class="date-filter-bar hidden" id="date-filter-bar">
      <span class="date-filter-text" id="date-filter-text"></span>
      <button type="button" class="date-filter-clear" id="date-filter-clear">ì „ì²´ ë³´ê¸°</button>
    </div>
    <div class="empty-state" id="empty-state">
      <p>ğŸ‰</p>
      <p>í• ì¼ì´ ì—†ì–´ìš”!</p>
    </div>
    <div id="todo-list-cards"></div>
  </main>

  <!-- â”€â”€â”€â”€â”€ ìŠ¤ì¼€ì¤„ ì°¨íŠ¸ ì„¹ì…˜ â”€â”€â”€â”€â”€ -->
  <section class="schedule-section" id="nav-schedule">
    <div class="schedule-header">
      <h2 class="schedule-title">ğŸ“… ì „ì²´ ì¼ì •</h2>
      <div class="month-nav">
        <button id="prev-month">â€¹</button>
        <span id="current-month-label"></span>
        <button id="next-month">â€º</button>
      </div>
    </div>
    <div class="schedule-chart" id="schedule-chart"></div>
  </section>

  <!-- í• ì¼ ì¶”ê°€ ëª¨ë‹¬ -->
  <div class="modal-overlay hidden" id="modal-overlay">
    <div class="modal" id="modal">
      <div class="modal-handle"></div>
      <h2 class="modal-title" id="modal-title">ìƒˆ í• ì¼</h2>
      <div class="form-group">
        <label>í• ì¼</label>
        <div class="input-wrapper">
          <input type="text" id="todo-input" placeholder="ë¬´ì—‡ì„ í•´ì•¼ í•˜ë‚˜ìš”?" autocomplete="off" />
          <ul class="autocomplete-list hidden" id="autocomplete-list"></ul>
        </div>
      </div>
      <div class="template-suggestion hidden" id="template-suggestion">
        <span>ğŸ’¡</span>
        <span id="template-name"></span>
        <button id="apply-template">ì ìš©</button>
      </div>
      <div class="form-row">
        <div class="form-group half">
          <label>ì¹´í…Œê³ ë¦¬</label>
          <select id="category-select">
            <option value="">ì—†ìŒ</option>
            <option value="ì—…ë¬´">ğŸ’¼ ì—…ë¬´</option>
            <option value="ê±´ê°•">ğŸƒ ê±´ê°•</option>
            <option value="í•™ìŠµ">ğŸ“š í•™ìŠµ</option>
            <option value="ìƒí™œ">ğŸ  ìƒí™œ</option>
          </select>
        </div>
        <div class="form-group half">
          <label>ìš°ì„ ìˆœìœ„</label>
          <select id="priority-select">
            <option value="medium">ë³´í†µ</option>
            <option value="high">ë†’ìŒ ğŸ”´</option>
            <option value="low">ë‚®ìŒ ğŸŸ¢</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group half">
          <label>ì‹œì‘ì¼</label>
          <input type="date" id="start-date-input" />
        </div>
        <div class="form-group half">
          <label>ë§ˆê°ì¼</label>
          <input type="date" id="deadline-input" />
        </div>
      </div>
      <div class="form-row form-row-all-day">
        <div class="form-group all-day-group">
          <label class="all-day-label">
            <input type="checkbox" id="all-day-checkbox" checked />
            <span>ì¢…ì¼</span>
          </label>
        </div>
        <div class="form-row time-inputs-row" id="time-inputs-row">
          <div class="form-group half">
            <label>ì‹œì‘ ì‹œê°„</label>
            <input type="time" id="start-time-input" value="00:00" disabled />
          </div>
          <div class="form-group half">
            <label>ì¢…ë£Œ ì‹œê°„</label>
            <input type="time" id="end-time-input" value="18:00" disabled />
          </div>
        </div>
      </div>
      <div class="subtask-suggestion hidden" id="subtask-suggestion">
        <label>ğŸ“Œ ì¶”ì²œ ì„¸ë¶€ ì‘ì—…</label>
        <div class="subtask-chips" id="subtask-chips"></div>
      </div>
      <div class="form-group">
        <label>ë©”ëª¨</label>
        <textarea id="memo-input" placeholder="ì¶”ê°€ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”" rows="2"></textarea>
      </div>
      <div class="modal-actions">
        <button class="btn-cancel" id="close-modal">ì·¨ì†Œ</button>
        <button class="btn-add" id="add-btn">ì¶”ê°€í•˜ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ë‚ ì§œ í´ë¦­ ì‹œ: í• ì¼ ìˆëŠ” ë‚  ì„ íƒ íŒì—… (ê¸°ì¡´ í• ì¼ë³´ê¸° / í• ì¼ ë“±ë¡í•˜ê¸°) -->
  <div class="date-choice-overlay hidden" id="date-choice-overlay">
    <div class="date-choice-popup">
      <p class="date-choice-title" id="date-choice-title"></p>
      <div class="date-choice-buttons">
        <button type="button" class="date-choice-btn date-choice-btn-view" id="date-choice-view">ì¼ì •ë³´ê¸°</button>
        <button type="button" class="date-choice-btn date-choice-btn-add" id="date-choice-add">í• ì¼ ë“±ë¡í•˜ê¸°</button>
      </div>
      <button type="button" class="date-choice-close" id="date-choice-close" aria-label="ë‹«ê¸°">âœ•</button>
    </div>
  </div>

  <!-- ì›í˜• ì‹œê³„ íƒ€ì„ í”¼ì»¤ -->
  <div class="time-picker-overlay hidden" id="time-picker-overlay">
    <div class="time-picker-popup">
      <p class="time-picker-title" id="time-picker-title">ì‹œê°„ ì„ íƒ</p>
      <div class="time-picker-mode-row">
        <button type="button" class="time-picker-mode-btn active" id="time-picker-mode-hour">ì‹œ ì„ íƒ</button>
        <button type="button" class="time-picker-mode-btn" id="time-picker-mode-minute">ë¶„ ì„ íƒ</button>
      </div>
      <div class="clock-wrap">
        <div class="clock-face" id="clock-face">
          <div class="clock-hand clock-hand-hour" id="clock-hand-hour"></div>
          <div class="clock-hand clock-hand-minute" id="clock-hand-minute"></div>
        </div>
      </div>
      <div class="time-picker-ampm-row">
        <button type="button" class="time-picker-ampm-btn" id="time-picker-am">ì˜¤ì „</button>
        <button type="button" class="time-picker-ampm-btn" id="time-picker-pm">ì˜¤í›„</button>
        <button type="button" class="time-picker-ampm-btn" id="time-picker-all-day">ì¢…ì¼</button>
      </div>
      <input type="text" class="time-picker-display" id="time-picker-display" value="00:00" placeholder="ì˜¤ì „ 12:00" />
      <div class="time-picker-actions">
        <button type="button" class="btn-cancel time-picker-cancel" id="time-picker-cancel">ì·¨ì†Œ</button>
        <button type="button" class="date-choice-btn date-choice-btn-add" id="time-picker-apply">ì ìš©</button>
      </div>
    </div>
  </div>

  <!-- Firebase Realtime Database -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      set,
      push,
      onValue,
      remove,
      update,
      goOnline
    } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDe6wQl7i3kwD0jPMPUP97KGfQuiPh5u8I",
      authDomain: "aif-todo-backend.firebaseapp.com",
      databaseURL: "https://aif-todo-backend-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "aif-todo-backend",
      storageBucket: "aif-todo-backend.firebasestorage.app",
      messagingSenderId: "968012722020",
      appId: "1:968012722020:web:316e9d0cb3bcbe4d35d471",
      measurementId: "G-S85KYGSHDK"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    goOnline(db);

    window._db = db;
    window._ref = ref;
    window._set = set;
    window._push = push;
    window._onValue = onValue;
    window._remove = remove;
    window._update = update;

    const script = document.createElement("script");
    script.src = "js/suggest.js";
    document.body.appendChild(script);
  </script>

</body>
</html>
